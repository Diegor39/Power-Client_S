<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <title>007</title>
  </head>
  <body>
    <h1>Salvemos al mundo</h1>

    <form method="POST">
        
        <div class="form-group">
          <label for="exampleFormControlTextarea1">Introduce el codigo</label>
          <textarea class="form-control" id="secreto" rows="3" name="Bomba"></textarea>
        </div>
        <button type="button" id="enviar" class="btn btn-light">Solo hazloooo!!!</button>
    </form>

    <div id="result"></div>

    
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    -->
    <script>
    var btn = document.getElementById("enviar");
    btn.addEventListener("click", function(){
      mensaje=document.getElementById("secreto").value;
      console.log(mensaje);
      res=document.getElementById("result");
      res.innerHTML="descifrando....";

      $.ajax({
        method:"POST",
        url:"/",
        data:{Bomba:mensaje},
        dataType:"json",
        success:function(response){
          console.log(response);
          //var datos = JSON.parse(response);
          var idioma=response.documents[0].detectedLanguage.name
          //console.log(response.documents[0].detectedLanguage.name);
          res.innerHTML=idioma;
        }
      });
    });
/*
    function callback_function(resultadoJ){
      console.log(resultadoJ)
      console.log("se envio la data")
      var consulta = new XMLHttpRequest();
      consulta.open('GET','/');
      consulta.onload = function () {
      console.log('Cargo');
      var datos = JSON.parse(consulta.responseText);
      console.log(datos[0].detectedLanguage.name[0]);}
      //res.innerHTML=datos[0].detectedLanguage.name[0];
    };*/
    
    </script>

  </body>
</html>